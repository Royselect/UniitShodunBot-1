import telebot
from telebot import types

#тег бота: @UniitShodunBot
bot = telebot.TeleBot('5877928916:AAHWzT4YLy9UNaOCQOtp1dTRH-7GK3wIneM') #token
chat_id = '-858519698'

"""
Бот в Telegram для парсинга инфы с shodan и поиска эксплойтов на exploit-db
> План:
1. авторизация на shodan
2. парсинг shodan
3. отправка инфы юзеру
4. вход на exploit-db
5. поиск эксплойтов
6. отправка инфы юзеру
"""

@bot.message_handler(commands=['start']) # реакция на /start
def start(message):
    bot.send_message(chat_id, "hello1")
    # bot.send_message(message.from_user.id, "hello1")

# exploit-db    
import atoma, requests
feed_name = "Exploit-DB.com RSS Feed"
url = "https://www.exploit-db.com/rss.xml"
response = requests.get(url)
feed = atoma.parse_rss_bytes(response.content)

date1 = feed.pub_date.strftime('%d-%m-%Y')
print ("Feed: " + feed.title)
print ("Description: " + feed.description)
print ("Link: " + feed.link)
print ("Feed Update: " + date1)

for post in feed.items:
    date2 = post.pub_date.strftime('%d-%m-%Y')
    print ("Published Date: " + date2)
    print ("Title: " + post.description)
    print ("Description: " + post.title)
    print ("Link: " + post.link)

@bot.message_handler(commands=['exploit'])
def start(message):
    bot.send_message(chat_id, "Published Date: " + date2
                                            + "\nTitle: " + post.description
                                            + "\nDescription: " + post.title
                                            + "\nLink: " + post.link)




if __name__ == '__main__':
    bot.infinity_polling()
